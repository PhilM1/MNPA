%MNPA for ELEC4700
%Philippe Masson

R1 = 1;
Cap = 0.25;
R2 = 2;
L = 0.2;
R3 = 10;
a = 100;
R4 = 0.1;
R0 = 1000;
Vin = -10;
freq = 100;

%    I1, I2, I3,   V3,   V2,    V1,  V
G =[ -1,  1,  1,    0,    0,     0,  0;
      0,  0,  0,   -1,    1,     0,  0; 
     -1,  0,  0,    0, 1/R1, -1/R1,  0;
      0,  0, -1, 1/R3,    1,     0,  0;
      0, -1,  0,    0, 1/R2,     0,  0;     
      0,  0,  a,    0,    0,     0, -1; 
      0,  0,  0,    0,    0,     1,  0];
  
C = [ 0,  0,  0,    0,    0,     0,  0;
      0,  0,  L,    0,    0,     0,  0; 
      0,  0,  0,    0,  Cap,  -Cap,  0;
      0,  0,  0,    0,    0,     0,  0;
      0,  0,  0,    0,    0,     0,  0;    
      0,  0,  0,    0,    0,     0,  0;
      0,  0,  0,    0,    0,     0,  0];
  
F = [0;
     0;
     0;
     0;
     0;
     Vin;
     0];
 
 
 %DC Sweep
 VDC = G\F;
 
 %AC Sweep;
 VAC = (G+j*2*pi*freq*C)\F;
     